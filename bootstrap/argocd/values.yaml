global:
  domain: argocd.typie.io

redis:
  podAnnotations:
    ad.datadoghq.com/exclude: "true"

configs:
  cm:
    resource.customizations.ignoreDifferences.external-secrets.io_ExternalSecret:
      |
      jqPathExpressions:
        - .spec.data[].remoteRef | .conversionStrategy, .decodingStrategy, .metadataPolicy
        - .spec.dataFrom[].find | .conversionStrategy, .decodingStrategy

    resource.customizations.knownTypeFields.argoproj.io_Rollout: |
      - field: spec.template.spec
        type: core/v1/PodSpec

    resource.customizations.ignoreDifferences.postgresql.cnpg.io_Cluster: |
      jqPathExpressions:
        - .spec.affinity
        - .spec.enableSuperuserAccess
        - .spec.failoverDelay
        - .spec.logLevel
        - .spec.maxSyncReplicas
        - .spec.minSyncReplicas
        - .spec.monitoring
        - .spec.postgresGID
        - .spec.postgresUID
        - .spec.primaryUpdateStrategy
        - .spec.probes
        - .spec.smartShutdownTimeout
        - .spec.startDelay
        - .spec.stopDelay
        - .spec.switchoverDelay
        - .spec.bootstrap.initdb.database
        - .spec.bootstrap.initdb.encoding
        - .spec.bootstrap.initdb.localeCType
        - .spec.bootstrap.initdb.localeCollate
        - .spec.bootstrap.initdb.owner
        - .spec.managed.roles[].connectionLimit
        - .spec.managed.roles[].ensure
        - .spec.managed.roles[].inherit
        - .spec.plugins[].enabled
        - .spec.postgresql.syncReplicaElectionConstraint
        - .spec.postgresql.parameters.archive_mode
        - .spec.postgresql.parameters.archive_timeout
        - .spec.postgresql.parameters.dynamic_shared_memory_type
        - .spec.postgresql.parameters.full_page_writes
        - .spec.postgresql.parameters.log_destination
        - .spec.postgresql.parameters.log_directory
        - .spec.postgresql.parameters.log_filename
        - .spec.postgresql.parameters.log_rotation_age
        - .spec.postgresql.parameters.log_rotation_size
        - .spec.postgresql.parameters.log_truncate_on_rotation
        - .spec.postgresql.parameters.logging_collector
        - .spec.postgresql.parameters.max_replication_slots
        - .spec.postgresql.parameters.shared_memory_type
        - .spec.postgresql.parameters.shared_preload_libraries
        - .spec.postgresql.parameters.ssl_max_protocol_version
        - .spec.postgresql.parameters.ssl_min_protocol_version
        - .spec.postgresql.parameters.wal_level
        - .spec.postgresql.parameters.wal_log_hints
        - .spec.postgresql.parameters.wal_receiver_timeout
        - .spec.postgresql.parameters.wal_sender_timeout
        - .spec.replicationSlots.highAvailability.slotPrefix
        - .spec.replicationSlots.synchronizeReplicas
        - .spec.replicationSlots.updateInterval
        - .spec.storage.resizeInUseVolumes
        - .spec.walStorage.resizeInUseVolumes

    resource.customizations.ignoreDifferences.postgresql.cnpg.io_Database: |
      jqPathExpressions:
        - .spec.databaseReclaimPolicy
        - .spec.ensure
        - .spec.extensions[].ensure
        - .spec.schemas[].ensure

    resource.exclusions: |
      - apiGroups:
        - discovery.k8s.io
        kinds:
        - EndpointSlice
      - apiGroups:
        - coordination.k8s.io
        kinds:
        - Lease
      - apiGroups:
        - cert-manager.io
        kinds:
        - CertificateRequest
      - apiGroups:
        - cilium.io
        kinds:
        - CiliumIdentity
        - CiliumEndpoint
        - CiliumEndpointSlice

server:
  ingress:
    enabled: true
    ingressClassName: cilium

    annotations:
      ingress.cilium.io/tls-passthrough: enabled
      ingress.cilium.io/force-https: enabled
      external-dns.typie.io/enabled: "true"

    tls: true

  certificate:
    enabled: true
    issuer:
      group: cert-manager.io
      kind: ClusterIssuer
      name: letsencrypt
